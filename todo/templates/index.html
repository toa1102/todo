<!DOCTYPE html>
<html lang='ja'>

<head>
    <meta charset='utf-8' />
    <link rel='stylesheet' href='/static/css/style.css'>
    <title>TODOアプリ</title>
    <script
    src="https://code.jquery.com/jquery-3.5.1.js"
    integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>
</head>

<body>
    <main>
        <div id='title' class='title'>タスク</div>
        <form name='f' method='post'>
            <div class='text_area'><input type='text' name='new_text' id='new_text'></div>
            <table>
{% for task in tasks %}<!--１-->
                <tr>
                    <td
                        class='card'
                        id='task_{{task.id}}'
                        style="{% if task.status == 1 %}background-color:#FFFF00;{% else %}background-color:#FFFFFF;{% endif %}"
                        task_id='{{task.id}}'>{{ task.text }}
                        <!-- task.statusが1の場合#FFFF00(黄色)、0の場合#FFFFFF(白色)が適用される -->
                        <!-- {{task.id}}や{{task.text}}はtaskリストのidやtextを埋め込んでいる -->
                    </td>
                </tr>
{% endfor %}<!-- 16行目とこの行で囲んだ部分でtasksのリストデータ分ループさせて、中のtr要素を複数生成していく -->
            </table>
            <input type="hidden" name="id" id="id">
        </form>
    </main>
    <!-- 2 -->
    <script>
        $(document).ready(function(){
            $('#new_text').keydown(function(e) {
                if (e.keyCode == 13) {
                    $('form[name="f"]').attr('action', '/new')
                    $('form[name="f"]').submit();
                }
            });
        });
    </script>
    <!-- 2からここまでのコードについて -->
    <!-- keyCodeの13がEnterに該当。 -->
    <!-- Enterを押したらフォームのactionに/newを指定しサブミット。 -->
    <!-- これでEnterを押した時登録できる。 -->
    <script type="text/javascript" src="/static/js/jquery.longpress.js"></script>
    <script>
        $(document).ready(function(){
            $('#new_text').keydown(function(e) {
                if (e.keyCode == 13) {
                    $('form[name="f"]').attr('action', '/new')
                    $('from[name="f"]').submit();
                }
            });
            $('.card').longpress(function() {
                var id = $(this).attr("task_id");
                $('#id').val(id);
                $('form[name="f"]').attr('action', '/completion');
                $('form[name="f"]').submit();
            },
                1000
            );
        });
    </script>
</body>

</html>